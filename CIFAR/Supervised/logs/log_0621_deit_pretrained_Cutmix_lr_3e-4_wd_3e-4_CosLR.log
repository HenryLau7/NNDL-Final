nohup: ignoring input
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:63: UserWarning: Overwriting deit_tiny_patch16_224 in registry with deit.deit_tiny_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:78: UserWarning: Overwriting deit_small_patch16_224 in registry with deit.deit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:93: UserWarning: Overwriting deit_base_patch16_224 in registry with deit.deit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:108: UserWarning: Overwriting deit_tiny_distilled_patch16_224 in registry with deit.deit_tiny_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:123: UserWarning: Overwriting deit_small_distilled_patch16_224 in registry with deit.deit_small_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:138: UserWarning: Overwriting deit_base_distilled_patch16_224 in registry with deit.deit_base_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:153: UserWarning: Overwriting deit_base_patch16_384 in registry with deit.deit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_384(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:168: UserWarning: Overwriting deit_base_distilled_patch16_384 in registry with deit.deit_base_distilled_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_384(pretrained=False, **kwargs):
deit_small的参数量: 22.05M
{
    "datapath": "../data/",
    "logpath": "./logs/",
    "batch_size": 512,
    "epoch": 100,
    "seed": 43,
    "date": "0621",
    "plot": true,
    "num_classes": 100,
    "learning_rate": 0.0003,
    "weight_decay": 0.0003,
    "pretrained": true,
    "device_id": 1,
    "dropout": true,
    "cutout": false,
    "cutmix": true,
    "model": "deit",
    "comment": "CosLR"
}
2024-06-21 23:39:34
Epoch:0, Loss:2.83088432647744, Acc:37.57, LR:0.0002999259840548597
Epoch:1, Loss:1.9016386532053655, Acc:55.596, LR:0.0002997040092642407
Epoch:2, Loss:1.7275551289928204, Acc:58.278, LR:0.000299334294690462
Epoch:3, Loss:1.5834972533036251, Acc:59.1, LR:0.0002988172051971717
Epoch:4, Loss:1.5432960950598424, Acc:61.058, LR:0.00029815325108927063
Validation: Loss:0.5140026777982711, Acc:84.73
Best model updated!
Epoch:5, Loss:1.4523593369795351, Acc:65.274, LR:0.00029734308760930326
Epoch:6, Loss:1.4695222289586554, Acc:65.532, LR:0.00029638751429081204
Epoch:7, Loss:1.431356006739091, Acc:66.806, LR:0.0002952874741692946
Epoch:8, Loss:1.3433199369785738, Acc:70.078, LR:0.00029404405285154137
Epoch:9, Loss:1.3981672102699474, Acc:67.742, LR:0.0002926584774442729
Validation: Loss:0.5283120334148407, Acc:84.59
Epoch:10, Loss:1.357114666578721, Acc:68.486, LR:0.00029113211534313374
Epoch:11, Loss:1.337013770731128, Acc:70.956, LR:0.0002894664728832376
Epoch:12, Loss:1.2492498690072371, Acc:69.378, LR:0.0002876631938525971
Epoch:13, Loss:1.2797263942810955, Acc:68.654, LR:0.0002857240578699029
Epoch:14, Loss:1.327685381380879, Acc:68.102, LR:0.00028365097862825513
Validation: Loss:0.49308030158281324, Acc:85.29
Best model updated!
Epoch:15, Loss:1.2897578103809941, Acc:67.806, LR:0.0002814460020065795
Epoch:16, Loss:1.2797301405546617, Acc:67.622, LR:0.0002791113040505915
Epoch:17, Loss:1.3223716869037978, Acc:66.294, LR:0.00027664918882530225
Epoch:18, Loss:1.2383007644390573, Acc:68.996, LR:0.00027406208614118424
Epoch:19, Loss:1.2539172094999527, Acc:66.566, LR:0.0002713525491562421
Validation: Loss:0.5256301239132881, Acc:85.0
Epoch:20, Loss:1.2351870383231007, Acc:69.796, LR:0.00026852325185635354
Epoch:21, Loss:1.2436545278344835, Acc:71.196, LR:0.0002655769864163684
Epoch:22, Loss:1.2361374568878387, Acc:70.014, LR:0.00026251666044456895
Epoch:23, Loss:1.2037171579289192, Acc:70.27, LR:0.0002593452941132118
Epoch:24, Loss:1.1998512830053056, Acc:71.758, LR:0.0002560660171779822
Validation: Loss:0.5522873625159264, Acc:84.19
Epoch:25, Loss:1.195922267832318, Acc:70.812, LR:0.00025268206588930335
Epoch:26, Loss:1.1599849974926637, Acc:70.38, LR:0.0002491967797985478
Epoch:27, Loss:1.2106041746328071, Acc:67.444, LR:0.0002456135984623035
Epoch:28, Loss:1.1820099491397946, Acc:68.456, LR:0.00024193605804794655
Epoch:29, Loss:1.2129994985096308, Acc:68.304, LR:0.00023816778784387105
Validation: Loss:0.58022381067276, Acc:83.78
Epoch:30, Loss:1.1532568933100116, Acc:72.58, LR:0.00023431250667781966
Epoch:31, Loss:1.192521637495683, Acc:68.768, LR:0.00023037401924684952
Epoch:32, Loss:1.1634503978551651, Acc:68.922, LR:0.00022635621236255572
Epoch:33, Loss:1.1194603549582618, Acc:69.29, LR:0.00022226305111525731
Epoch:34, Loss:1.1477186983945418, Acc:70.006, LR:0.00021809857496093204
Validation: Loss:0.5656623750925064, Acc:84.23
Epoch:35, Loss:1.1222332866520297, Acc:72.712, LR:0.00021386689373476092
Epoch:36, Loss:1.1269799078605613, Acc:72.46, LR:0.00020957218359521712
Epoch:37, Loss:1.1327087921755654, Acc:73.672, LR:0.00020521868290270177
Epoch:38, Loss:1.1265959642371353, Acc:72.016, LR:0.00020081068803679377
Epoch:39, Loss:1.1078376533577636, Acc:68.526, LR:0.00019635254915624216
Validation: Loss:0.5813635617494584, Acc:84.13
Epoch:40, Loss:1.056132586178731, Acc:74.366, LR:0.00019184866590588444
Epoch:41, Loss:1.0770835943368016, Acc:75.202, LR:0.00018730348307472821
Epoch:42, Loss:1.0577025602058487, Acc:71.93, LR:0.00018272148620948142
Epoch:43, Loss:1.00441034214229, Acc:75.178, LR:0.00017810719718785875
Epoch:44, Loss:1.0938452752877255, Acc:66.272, LR:0.00017346516975603468
Validation: Loss:0.5752311766147613, Acc:84.42
Epoch:45, Loss:1.037707932749573, Acc:73.99, LR:0.0001687999850346457
Epoch:46, Loss:1.0459316886809407, Acc:72.712, LR:0.00016411624699777717
Epoch:47, Loss:1.0288202193926792, Acc:75.074, LR:0.00015941857792939706
Epoch:48, Loss:0.9829106730770092, Acc:77.394, LR:0.00015471161386171927
Epoch:49, Loss:0.9695195319245056, Acc:72.5, LR:0.00015000000000000001
Validation: Loss:0.6145407587289811, Acc:84.12
Epoch:50, Loss:1.0254578169207185, Acc:73.844, LR:0.00014528838613828078
Epoch:51, Loss:1.0150664491312844, Acc:71.872, LR:0.00014058142207060302
Epoch:52, Loss:0.9634816254280052, Acc:74.316, LR:0.00013588375300222289
Epoch:53, Loss:0.9715214776141303, Acc:76.518, LR:0.0001312000149653544
Epoch:54, Loss:0.9098833530228965, Acc:76.734, LR:0.0001265348302439654
Validation: Loss:0.6203576117753983, Acc:84.24
Epoch:55, Loss:0.965492481403813, Acc:74.978, LR:0.00012189280281214134
Epoch:56, Loss:0.8960651520411579, Acc:78.976, LR:0.00011727851379051869
Epoch:57, Loss:0.9278320838906327, Acc:78.32, LR:0.0001126965169252718
Epoch:58, Loss:0.8978161192974266, Acc:78.63, LR:0.00010815133409411566
Epoch:59, Loss:0.9215267197970225, Acc:77.522, LR:0.00010364745084375796
Validation: Loss:0.6301127374172211, Acc:83.82
Epoch:60, Loss:0.9192663360463114, Acc:77.276, LR:9.918931196320633e-05
Epoch:61, Loss:0.8970090981040683, Acc:81.096, LR:9.478131709729838e-05
Epoch:62, Loss:0.9140128072123138, Acc:75.842, LR:9.042781640478292e-05
Epoch:63, Loss:0.9164045490324497, Acc:73.478, LR:8.613310626523913e-05
Epoch:64, Loss:0.855862503947348, Acc:77.038, LR:8.190142503906802e-05
Validation: Loss:0.6293306708335876, Acc:83.98
Epoch:65, Loss:0.9225734943638042, Acc:72.37, LR:7.773694888474271e-05
Epoch:66, Loss:0.8731654732659155, Acc:74.008, LR:7.364378763744433e-05
Epoch:67, Loss:0.890522593290222, Acc:70.096, LR:6.96259807531505e-05
Epoch:68, Loss:0.9224058140297325, Acc:72.37, LR:6.568749332218042e-05
Epoch:69, Loss:0.8774538183850902, Acc:77.172, LR:6.183221215612908e-05
Validation: Loss:0.6074508965015412, Acc:84.57
Epoch:70, Loss:0.8753714074893874, Acc:77.78, LR:5.806394195205354e-05
Epoch:71, Loss:0.7847896479070187, Acc:83.922, LR:5.438640153769656e-05
Epoch:72, Loss:0.8395982123151118, Acc:79.556, LR:5.080322020145227e-05
Epoch:73, Loss:0.806871446343709, Acc:77.468, LR:4.731793411069671e-05
Epoch:74, Loss:0.777180807094793, Acc:82.514, LR:4.39339828220179e-05
Validation: Loss:0.6345974713563919, Acc:84.49
Epoch:75, Loss:0.8042834348862573, Acc:75.318, LR:4.065470588678832e-05
Epoch:76, Loss:0.8113050357419618, Acc:74.756, LR:3.7483339555431075e-05
Epoch:77, Loss:0.7934739194354232, Acc:82.838, LR:3.442301358363164e-05
Epoch:78, Loss:0.7781927418343875, Acc:76.582, LR:3.147674814364645e-05
Epoch:79, Loss:0.8117342502334897, Acc:74.922, LR:2.8647450843757908e-05
Validation: Loss:0.6265608429908752, Acc:84.7
Epoch:80, Loss:0.789838505262623, Acc:79.704, LR:2.5937913858815748e-05
Epoch:81, Loss:0.7977140269109181, Acc:76.424, LR:2.3350811174697777e-05
Epoch:82, Loss:0.8111846324588571, Acc:79.242, LR:2.088869594940844e-05
Epoch:83, Loss:0.7974819025138811, Acc:76.95, LR:1.8553997993420465e-05
Epoch:84, Loss:0.8113594740933302, Acc:74.778, LR:1.6349021371744834e-05
Validation: Loss:0.6269187599420547, Acc:84.91
Epoch:85, Loss:0.8151712242741974, Acc:75.144, LR:1.4275942130097098e-05
Epoch:86, Loss:0.7466514413910252, Acc:81.998, LR:1.2336806147402864e-05
Epoch:87, Loss:0.7887745866818088, Acc:77.682, LR:1.0533527116762298e-05
Epoch:88, Loss:0.7771513268959765, Acc:78.784, LR:8.867884656866183e-06
Epoch:89, Loss:0.7637664301663029, Acc:82.318, LR:7.341522555726971e-06
Validation: Loss:0.6298080712556839, Acc:84.79
Epoch:90, Loss:0.7854759435796616, Acc:74.266, LR:5.955947148458557e-06
Epoch:91, Loss:0.7700895020852283, Acc:78.936, LR:4.712525830705355e-06
Epoch:92, Loss:0.7701117146988304, Acc:82.67, LR:3.612485709187901e-06
Epoch:93, Loss:0.7813299540050176, Acc:75.81, LR:2.6569123906966916e-06
Epoch:94, Loss:0.7887911974851575, Acc:72.37, LR:1.8467489107293509e-06
Validation: Loss:0.6362729340791702, Acc:84.74
Epoch:95, Loss:0.7487394930794835, Acc:79.502, LR:1.1827948028283352e-06
Epoch:96, Loss:0.7197997559584222, Acc:83.746, LR:6.657053095380005e-07
Epoch:97, Loss:0.7729248117123332, Acc:82.58, LR:2.9599073575926616e-07
Epoch:98, Loss:0.7496534117250419, Acc:83.866, LR:7.401594514025999e-08
Epoch:99, Loss:0.7492868587070581, Acc:78.968, LR:0.0
Validation: Loss:0.6369689643383026, Acc:84.9
Test: Acc:85.29
