nohup: ignoring input
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:63: UserWarning: Overwriting deit_tiny_patch16_224 in registry with deit.deit_tiny_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:78: UserWarning: Overwriting deit_small_patch16_224 in registry with deit.deit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:93: UserWarning: Overwriting deit_base_patch16_224 in registry with deit.deit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:108: UserWarning: Overwriting deit_tiny_distilled_patch16_224 in registry with deit.deit_tiny_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:123: UserWarning: Overwriting deit_small_distilled_patch16_224 in registry with deit.deit_small_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:138: UserWarning: Overwriting deit_base_distilled_patch16_224 in registry with deit.deit_base_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:153: UserWarning: Overwriting deit_base_patch16_384 in registry with deit.deit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_384(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:168: UserWarning: Overwriting deit_base_distilled_patch16_384 in registry with deit.deit_base_distilled_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_384(pretrained=False, **kwargs):
deit_small的参数量: 22.05M
{
    "datapath": "../data/",
    "logpath": "./logs/",
    "batch_size": 512,
    "epoch": 100,
    "seed": 43,
    "date": "0621",
    "plot": true,
    "num_classes": 100,
    "learning_rate": 0.0003,
    "weight_decay": 0.0003,
    "pretrained": true,
    "device_id": 1,
    "dropout": true,
    "cutout": true,
    "model": "deit",
    "setting": "regular"
}
<class '__main__.args'>
Pretrained=True, Training with lr=0.0003, decay=0.0003
2024-06-21 15:58:49
Epoch:0, Loss:1.5418065914085932, Acc:61.69, LR:0.0002999259840548597
Epoch:1, Loss:0.5446277148261363, Acc:83.602, LR:0.0002997040092642407
Epoch:2, Loss:0.3777563955102648, Acc:88.398, LR:0.000299334294690462
Epoch:3, Loss:0.27257966067718, Acc:91.53, LR:0.0002988172051971717
Epoch:4, Loss:0.22282729586776423, Acc:92.958, LR:0.00029815325108927063
Validation: Loss:0.5389117285609245, Acc:84.47
Best model updated!
Epoch:5, Loss:0.19109272531100682, Acc:93.938, LR:0.00029734308760930326
Epoch:6, Loss:0.1640669539266703, Acc:94.772, LR:0.00029638751429081204
Epoch:7, Loss:0.16001195323710538, Acc:94.88, LR:0.0002952874741692946
Epoch:8, Loss:0.15020967062030519, Acc:95.34, LR:0.00029404405285154137
Epoch:9, Loss:0.1334669480518419, Acc:95.718, LR:0.0002926584774442729
Validation: Loss:0.6295710742473603, Acc:83.44
Epoch:10, Loss:0.11844647903831637, Acc:96.234, LR:0.00029113211534313374
Epoch:11, Loss:0.11110477012639143, Acc:96.47, LR:0.0002894664728832376
Epoch:12, Loss:0.12062987274661356, Acc:96.22, LR:0.0002876631938525971
Epoch:13, Loss:0.12308739916402467, Acc:96.148, LR:0.0002857240578699029
Epoch:14, Loss:0.11541923622087556, Acc:96.298, LR:0.00028365097862825513
Validation: Loss:0.6938598304986954, Acc:82.36
Epoch:15, Loss:0.10046259865012704, Acc:96.932, LR:0.0002814460020065795
Epoch:16, Loss:0.11377041471399824, Acc:96.46, LR:0.0002791113040505915
Epoch:17, Loss:0.10396778842016142, Acc:96.748, LR:0.00027664918882530225
Epoch:18, Loss:0.10341576996202372, Acc:96.854, LR:0.00027406208614118424
Epoch:19, Loss:0.09310680373134661, Acc:97.1, LR:0.0002713525491562421
Validation: Loss:0.751323539018631, Acc:82.05
Epoch:20, Loss:0.10132789976742802, Acc:96.796, LR:0.00026852325185635354
Epoch:21, Loss:0.0941328009476467, Acc:97.1, LR:0.0002655769864163684
Epoch:22, Loss:0.08730288537941416, Acc:97.264, LR:0.00026251666044456895
Epoch:23, Loss:0.09236513104821954, Acc:97.092, LR:0.0002593452941132118
Epoch:24, Loss:0.08864494975732297, Acc:97.236, LR:0.0002560660171779822
Validation: Loss:0.7649225324392319, Acc:81.66
Epoch:25, Loss:0.08503733183808472, Acc:97.364, LR:0.00025268206588930335
Epoch:26, Loss:0.08800503679988336, Acc:97.228, LR:0.0002491967797985478
Epoch:27, Loss:0.07642027705299612, Acc:97.628, LR:0.0002456135984623035
Epoch:28, Loss:0.07286520701433931, Acc:97.76, LR:0.00024193605804794655
Epoch:29, Loss:0.08459245356522044, Acc:97.348, LR:0.00023816778784387105
Validation: Loss:0.8262242794036865, Acc:80.29
Epoch:30, Loss:0.07812501596552986, Acc:97.626, LR:0.00023431250667781966
Epoch:31, Loss:0.0797884371891922, Acc:97.528, LR:0.00023037401924684952
Epoch:32, Loss:0.07496372876422745, Acc:97.734, LR:0.00022635621236255572
Epoch:33, Loss:0.07300277993235053, Acc:97.762, LR:0.00022226305111525731
Epoch:34, Loss:0.06471434440843914, Acc:98.05, LR:0.00021809857496093204
Validation: Loss:0.7921055972576141, Acc:81.22
Epoch:35, Loss:0.05784912962390452, Acc:98.296, LR:0.00021386689373476092
Epoch:36, Loss:0.07145329367141334, Acc:97.798, LR:0.00020957218359521712
Epoch:37, Loss:0.06324712304892588, Acc:98.124, LR:0.00020521868290270177
Epoch:38, Loss:0.058511646084335386, Acc:98.266, LR:0.00020081068803679377
Epoch:39, Loss:0.05407952515370384, Acc:98.414, LR:0.00019635254915624216
Validation: Loss:0.8406931638717652, Acc:80.63
Epoch:40, Loss:0.05478418340944514, Acc:98.382, LR:0.00019184866590588444
Epoch:41, Loss:0.06093423467661653, Acc:98.14, LR:0.00018730348307472821
Epoch:42, Loss:0.05919821809369082, Acc:98.184, LR:0.00018272148620948142
Epoch:43, Loss:0.0633256517882858, Acc:98.054, LR:0.00017810719718785875
Epoch:44, Loss:0.05628394058012232, Acc:98.314, LR:0.00017346516975603468
Validation: Loss:0.857661634683609, Acc:80.22
Epoch:45, Loss:0.04914408768242111, Acc:98.548, LR:0.0001687999850346457
Epoch:46, Loss:0.044250469084601014, Acc:98.696, LR:0.00016411624699777717
Epoch:47, Loss:0.04663640391841835, Acc:98.636, LR:0.00015941857792939706
Epoch:48, Loss:0.046682659992758106, Acc:98.66, LR:0.00015471161386171927
Epoch:49, Loss:0.04092965784425638, Acc:98.834, LR:0.00015000000000000001
Validation: Loss:0.8286155521869659, Acc:81.06
Epoch:50, Loss:0.03558775217139295, Acc:99.0, LR:0.00014528838613828078
Epoch:51, Loss:0.03607795263013365, Acc:98.944, LR:0.00014058142207060302
Epoch:52, Loss:0.03014411552980238, Acc:99.196, LR:0.00013588375300222289
Epoch:53, Loss:0.03363224036269346, Acc:99.056, LR:0.0001312000149653544
Epoch:54, Loss:0.03254130309713738, Acc:99.102, LR:0.0001265348302439654
Validation: Loss:0.8820634663105011, Acc:80.33
Epoch:55, Loss:0.0360162707653885, Acc:99.034, LR:0.00012189280281214134
Epoch:56, Loss:0.03225429687763051, Acc:99.062, LR:0.00011727851379051869
Epoch:57, Loss:0.030027235535030464, Acc:99.18, LR:0.0001126965169252718
Epoch:58, Loss:0.026733253474290272, Acc:99.25, LR:0.00010815133409411566
Epoch:59, Loss:0.025813268811194872, Acc:99.314, LR:0.00010364745084375796
Validation: Loss:0.8751562744379043, Acc:80.93
Epoch:60, Loss:0.02232199814170599, Acc:99.366, LR:9.918931196320633e-05
Epoch:61, Loss:0.017548728164057344, Acc:99.538, LR:9.478131709729838e-05
Epoch:62, Loss:0.01900195743774577, Acc:99.524, LR:9.042781640478292e-05
Epoch:63, Loss:0.024303640467019712, Acc:99.37, LR:8.613310626523913e-05
Epoch:64, Loss:0.019508087351842195, Acc:99.488, LR:8.190142503906802e-05
Validation: Loss:0.8791404277086258, Acc:80.84
Epoch:65, Loss:0.018952632988137857, Acc:99.508, LR:7.773694888474271e-05
Epoch:66, Loss:0.01945671895803998, Acc:99.492, LR:7.364378763744433e-05
Epoch:67, Loss:0.013785637663297204, Acc:99.642, LR:6.96259807531505e-05
Epoch:68, Loss:0.015483219756231624, Acc:99.6, LR:6.568749332218042e-05
Epoch:69, Loss:0.012825527033597534, Acc:99.684, LR:6.183221215612908e-05
Validation: Loss:0.8588938981294632, Acc:82.14
Epoch:70, Loss:0.010367966112110535, Acc:99.76, LR:5.806394195205354e-05
Epoch:71, Loss:0.011171434799266257, Acc:99.716, LR:5.438640153769656e-05
Epoch:72, Loss:0.009384046104375501, Acc:99.796, LR:5.080322020145227e-05
Epoch:73, Loss:0.006948103313334286, Acc:99.868, LR:4.731793411069671e-05
Epoch:74, Loss:0.007254671863736395, Acc:99.85, LR:4.39339828220179e-05
Validation: Loss:0.8616077363491058, Acc:81.98
Epoch:75, Loss:0.007880909078545412, Acc:99.836, LR:4.065470588678832e-05
Epoch:76, Loss:0.0073412196111998385, Acc:99.852, LR:3.7483339555431075e-05
Epoch:77, Loss:0.0049024684098074025, Acc:99.9, LR:3.442301358363164e-05
Epoch:78, Loss:0.0040832512503565874, Acc:99.924, LR:3.147674814364645e-05
Epoch:79, Loss:0.00535248118638042, Acc:99.892, LR:2.8647450843757908e-05
Validation: Loss:0.8601467579603195, Acc:82.38
Epoch:80, Loss:0.0040526817165486215, Acc:99.934, LR:2.5937913858815748e-05
Epoch:81, Loss:0.004346842802728393, Acc:99.916, LR:2.3350811174697777e-05
Epoch:82, Loss:0.00415050738719197, Acc:99.926, LR:2.088869594940844e-05
Epoch:83, Loss:0.0032974475369864733, Acc:99.942, LR:1.8553997993420465e-05
Epoch:84, Loss:0.0028436983643308736, Acc:99.956, LR:1.6349021371744834e-05
Validation: Loss:0.864387646317482, Acc:82.26
Epoch:85, Loss:0.0028092962575658243, Acc:99.948, LR:1.4275942130097098e-05
Epoch:86, Loss:0.003157583770950382, Acc:99.93, LR:1.2336806147402864e-05
Epoch:87, Loss:0.003328931121136613, Acc:99.934, LR:1.0533527116762298e-05
Epoch:88, Loss:0.0030337061972965543, Acc:99.944, LR:8.867884656866183e-06
Epoch:89, Loss:0.0025280075615785103, Acc:99.962, LR:7.341522555726971e-06
Validation: Loss:0.8673063844442368, Acc:82.58
Epoch:90, Loss:0.0024089364997795498, Acc:99.972, LR:5.955947148458557e-06
Epoch:91, Loss:0.00225825437192558, Acc:99.962, LR:4.712525830705355e-06
Epoch:92, Loss:0.0022477252427868695, Acc:99.962, LR:3.612485709187901e-06
Epoch:93, Loss:0.002245895888855947, Acc:99.97, LR:2.6569123906966916e-06
Epoch:94, Loss:0.0021312147941991537, Acc:99.974, LR:1.8467489107293509e-06
Validation: Loss:0.8562745541334152, Acc:82.8
Epoch:95, Loss:0.0021348244745797496, Acc:99.966, LR:1.1827948028283352e-06
Epoch:96, Loss:0.0020722113407159945, Acc:99.966, LR:6.657053095380005e-07
Epoch:97, Loss:0.001981438960813518, Acc:99.978, LR:2.9599073575926616e-07
Epoch:98, Loss:0.0020177881399701747, Acc:99.97, LR:7.401594514025999e-08
Epoch:99, Loss:0.0019969244651515416, Acc:99.976, LR:0.0
Validation: Loss:0.8596055120229721, Acc:82.7
Test: Acc:84.47
