nohup: ignoring input
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:63: UserWarning: Overwriting deit_tiny_patch16_224 in registry with deit.deit_tiny_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:78: UserWarning: Overwriting deit_small_patch16_224 in registry with deit.deit_small_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:93: UserWarning: Overwriting deit_base_patch16_224 in registry with deit.deit_base_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:108: UserWarning: Overwriting deit_tiny_distilled_patch16_224 in registry with deit.deit_tiny_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_tiny_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:123: UserWarning: Overwriting deit_small_distilled_patch16_224 in registry with deit.deit_small_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_small_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:138: UserWarning: Overwriting deit_base_distilled_patch16_224 in registry with deit.deit_base_distilled_patch16_224. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_224(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:153: UserWarning: Overwriting deit_base_patch16_384 in registry with deit.deit_base_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_patch16_384(pretrained=False, **kwargs):
/root/liuyuanye/NNDL/Final/CIFAR/deit.py:168: UserWarning: Overwriting deit_base_distilled_patch16_384 in registry with deit.deit_base_distilled_patch16_384. This is because the name being registered conflicts with an existing name. Please check if this is not expected.
  def deit_base_distilled_patch16_384(pretrained=False, **kwargs):
{
    "datapath": "../data/",
    "logpath": "./logs/",
    "batch_size": 512,
    "epoch": 200,
    "seed": 43,
    "date": "0622",
    "plot": true,
    "num_classes": 100,
    "opt": "AdamW",
    "learning_rate": 0.0005,
    "weight_decay": 0.05,
    "pretrained": true,
    "device_id": 0,
    "dropout": false,
    "cutout": false,
    "cutmix": true,
    "model": "deit",
    "comment": "StepLR_30_0.2"
}
2024-06-22 19:36:01
Epoch:0, Loss:3.0229615155531437, Acc:33.696, LR:0.0005
Epoch:1, Loss:1.9095464075098232, Acc:53.562, LR:0.0005
Epoch:2, Loss:1.7450301416066227, Acc:57.612, LR:0.0005
Epoch:3, Loss:1.560094556029962, Acc:64.824, LR:0.0005
Epoch:4, Loss:1.4059296399354935, Acc:68.332, LR:0.0005
Validation: Loss:0.5571290209889412, Acc:83.81
Best model updated!
Epoch:5, Loss:1.4191226019543044, Acc:64.348, LR:0.0005
Epoch:6, Loss:1.3466702240462205, Acc:63.802, LR:0.0005
Epoch:7, Loss:1.3681698806431828, Acc:60.054, LR:0.0005
Epoch:8, Loss:1.297355639083045, Acc:63.806, LR:0.0005
Epoch:9, Loss:1.2406711304674343, Acc:69.044, LR:0.0005
Validation: Loss:0.5071874499320984, Acc:85.33
Best model updated!
Epoch:10, Loss:1.1777548172644206, Acc:67.274, LR:0.0005
Epoch:11, Loss:1.1740057973229154, Acc:67.924, LR:0.0005
Epoch:12, Loss:1.194437778725916, Acc:68.766, LR:0.0005
Epoch:13, Loss:1.086544045684289, Acc:72.274, LR:0.0005
Epoch:14, Loss:1.0852516186328567, Acc:77.55, LR:0.0005
Validation: Loss:0.5060478240251541, Acc:85.96
Best model updated!
Epoch:15, Loss:1.0977392246832653, Acc:71.082, LR:0.0005
Epoch:16, Loss:1.058917408847079, Acc:73.648, LR:0.0005
Epoch:17, Loss:1.0791461320251834, Acc:70.816, LR:0.0005
Epoch:18, Loss:1.067513100954951, Acc:72.844, LR:0.0005
Epoch:19, Loss:1.0255842184533879, Acc:74.864, LR:0.0005
Validation: Loss:0.5058969706296921, Acc:85.83
Epoch:20, Loss:1.026441790163517, Acc:75.64, LR:0.0005
Epoch:21, Loss:1.0381770791599945, Acc:69.606, LR:0.0005
Epoch:22, Loss:1.0014114565387064, Acc:72.878, LR:0.0005
Epoch:23, Loss:0.9629854520364683, Acc:74.724, LR:0.0005
Epoch:24, Loss:0.971308100436415, Acc:76.414, LR:0.0005
Validation: Loss:0.5507862463593483, Acc:85.79
Epoch:25, Loss:1.0018554415021623, Acc:74.068, LR:0.0005
Epoch:26, Loss:0.9670386843535365, Acc:77.402, LR:0.0005
Epoch:27, Loss:1.004654231576287, Acc:70.936, LR:0.0005
Epoch:28, Loss:0.9395156639571093, Acc:77.04, LR:0.0005
Epoch:29, Loss:1.045293353041824, Acc:69.524, LR:0.0001
Validation: Loss:0.5845050901174546, Acc:84.11
Epoch:30, Loss:0.9136811957067373, Acc:70.55, LR:0.0001
Epoch:31, Loss:0.8392707378584512, Acc:79.368, LR:0.0001
Epoch:32, Loss:0.8141194067287202, Acc:75.94, LR:0.0001
Epoch:33, Loss:0.7775302608022276, Acc:77.086, LR:0.0001
Epoch:34, Loss:0.7655239483835746, Acc:83.736, LR:0.0001
Validation: Loss:0.4890117675065994, Acc:87.14
Best model updated!
Epoch:35, Loss:0.7535075108349627, Acc:79.742, LR:0.0001
Epoch:36, Loss:0.7876503799034624, Acc:78.554, LR:0.0001
Epoch:37, Loss:0.7557598934793959, Acc:81.738, LR:0.0001
Epoch:38, Loss:0.7579534088774603, Acc:76.464, LR:0.0001
Epoch:39, Loss:0.7536617560046059, Acc:83.032, LR:0.0001
Validation: Loss:0.4973952561616898, Acc:87.16
Best model updated!
Epoch:40, Loss:0.7631522497656394, Acc:81.506, LR:0.0001
Epoch:41, Loss:0.7485810133571528, Acc:78.258, LR:0.0001
Epoch:42, Loss:0.7626201391828303, Acc:82.552, LR:0.0001
Epoch:43, Loss:0.7634184105815937, Acc:74.652, LR:0.0001
Epoch:44, Loss:0.7102348761138867, Acc:82.558, LR:0.0001
Validation: Loss:0.5056181341409683, Acc:86.99
Epoch:45, Loss:0.7197798822379234, Acc:85.298, LR:0.0001
Epoch:46, Loss:0.7190883213616147, Acc:85.08, LR:0.0001
Epoch:47, Loss:0.743136146466951, Acc:76.968, LR:0.0001
Epoch:48, Loss:0.7477056670705883, Acc:84.138, LR:0.0001
Epoch:49, Loss:0.7438595986031756, Acc:77.57, LR:0.0001
Validation: Loss:0.5039349630475044, Acc:86.79
Epoch:50, Loss:0.7576414374064426, Acc:79.68, LR:0.0001
Epoch:51, Loss:0.7152092113938867, Acc:81.774, LR:0.0001
Epoch:52, Loss:0.735395733077003, Acc:78.484, LR:0.0001
Epoch:53, Loss:0.728750832987075, Acc:85.238, LR:0.0001
Epoch:54, Loss:0.7218105455062219, Acc:78.084, LR:0.0001
Validation: Loss:0.512787526845932, Acc:86.74
Epoch:55, Loss:0.7094546482727235, Acc:81.63, LR:0.0001
Epoch:56, Loss:0.7384814892952539, Acc:80.766, LR:0.0001
Epoch:57, Loss:0.7041587795377994, Acc:85.104, LR:0.0001
Epoch:58, Loss:0.7013504175203187, Acc:82.724, LR:0.0001
Epoch:59, Loss:0.7010475936136684, Acc:84.394, LR:2e-05
Validation: Loss:0.5212803587317467, Acc:86.93
Epoch:60, Loss:0.6762389462365179, Acc:81.038, LR:2e-05
Epoch:61, Loss:0.7308024910031533, Acc:78.7, LR:2e-05
Epoch:62, Loss:0.7145679702564162, Acc:79.212, LR:2e-05
Epoch:63, Loss:0.6870137273942177, Acc:79.31, LR:2e-05
Epoch:64, Loss:0.7154181322881153, Acc:78.324, LR:2e-05
Validation: Loss:0.5123164966702461, Acc:87.39
Best model updated!
Epoch:65, Loss:0.7125357371203753, Acc:83.276, LR:2e-05
Epoch:66, Loss:0.6947916922520618, Acc:83.13, LR:2e-05
Epoch:67, Loss:0.7196343522899005, Acc:72.276, LR:2e-05
Epoch:68, Loss:0.64321547214474, Acc:85.826, LR:2e-05
Epoch:69, Loss:0.6831364438736013, Acc:84.12, LR:2e-05
Validation: Loss:0.5101640373468399, Acc:87.08
Epoch:70, Loss:0.67976881521849, Acc:81.144, LR:2e-05
Epoch:71, Loss:0.7158505601846442, Acc:82.43, LR:2e-05
Epoch:72, Loss:0.6672165660871839, Acc:86.034, LR:2e-05
Epoch:73, Loss:0.6886033318480667, Acc:79.418, LR:2e-05
Epoch:74, Loss:0.7143062230731759, Acc:75.956, LR:2e-05
Validation: Loss:0.5104653507471084, Acc:87.22
Epoch:75, Loss:0.6963955883164795, Acc:78.94, LR:2e-05
Epoch:76, Loss:0.67866230691422, Acc:77.376, LR:2e-05
Epoch:77, Loss:0.6729892247489521, Acc:80.65, LR:2e-05
Epoch:78, Loss:0.694989878608256, Acc:84.508, LR:2e-05
Epoch:79, Loss:0.7068303802183696, Acc:77.034, LR:2e-05
Validation: Loss:0.5041974261403084, Acc:87.1
Epoch:80, Loss:0.6888638667914332, Acc:77.386, LR:2e-05
Epoch:81, Loss:0.6768544244827056, Acc:87.808, LR:2e-05
Epoch:82, Loss:0.641196844253537, Acc:85.898, LR:2e-05
Epoch:83, Loss:0.6566974433253006, Acc:86.014, LR:2e-05
Epoch:84, Loss:0.6614131444723023, Acc:89.336, LR:2e-05
Validation: Loss:0.502506111562252, Acc:87.34
Epoch:85, Loss:0.6935913842551562, Acc:83.18, LR:2e-05
Epoch:86, Loss:0.656532176903316, Acc:83.844, LR:2e-05
Epoch:87, Loss:0.6682033763856304, Acc:86.664, LR:2e-05
Epoch:88, Loss:0.6353026608157218, Acc:84.616, LR:2e-05
Epoch:89, Loss:0.6815540866584194, Acc:78.578, LR:4.000000000000001e-06
Validation: Loss:0.5130264565348626, Acc:87.32
Epoch:90, Loss:0.6660508334028478, Acc:82.596, LR:4.000000000000001e-06
Epoch:91, Loss:0.6691026902016328, Acc:84.806, LR:4.000000000000001e-06
Epoch:92, Loss:0.6777594609528171, Acc:80.85, LR:4.000000000000001e-06
Epoch:93, Loss:0.707217021256077, Acc:76.988, LR:4.000000000000001e-06
Epoch:94, Loss:0.669708673443113, Acc:85.348, LR:4.000000000000001e-06
Validation: Loss:0.5117667809128761, Acc:87.36
Epoch:95, Loss:0.6747167627422177, Acc:85.624, LR:4.000000000000001e-06
Epoch:96, Loss:0.6748601601896237, Acc:77.516, LR:4.000000000000001e-06
Epoch:97, Loss:0.6545920092992636, Acc:86.272, LR:4.000000000000001e-06
Epoch:98, Loss:0.6613873423134186, Acc:88.114, LR:4.000000000000001e-06
Epoch:99, Loss:0.6727716934924223, Acc:85.336, LR:4.000000000000001e-06
Validation: Loss:0.5143187865614891, Acc:87.25
Epoch:100, Loss:0.681971046693471, Acc:83.59, LR:4.000000000000001e-06
Epoch:101, Loss:0.6975023254600107, Acc:82.218, LR:4.000000000000001e-06
Epoch:102, Loss:0.6433651546130374, Acc:88.282, LR:4.000000000000001e-06
Epoch:103, Loss:0.650537948751328, Acc:87.07, LR:4.000000000000001e-06
Epoch:104, Loss:0.6716504719640527, Acc:81.666, LR:4.000000000000001e-06
Validation: Loss:0.5146788343787193, Acc:87.18
Epoch:105, Loss:0.681689285768234, Acc:78.158, LR:4.000000000000001e-06
Epoch:106, Loss:0.6788400359907929, Acc:82.148, LR:4.000000000000001e-06
Epoch:107, Loss:0.6526668534747192, Acc:83.096, LR:4.000000000000001e-06
Epoch:108, Loss:0.6985660510099664, Acc:79.692, LR:4.000000000000001e-06
Epoch:109, Loss:0.662330374577824, Acc:85.772, LR:4.000000000000001e-06
Validation: Loss:0.5131647601723671, Acc:87.16
Epoch:110, Loss:0.687634638985809, Acc:81.646, LR:4.000000000000001e-06
Epoch:111, Loss:0.7100305700180481, Acc:79.48, LR:4.000000000000001e-06
Epoch:112, Loss:0.6885832615044652, Acc:83.942, LR:4.000000000000001e-06
Epoch:113, Loss:0.6919576706440778, Acc:78.892, LR:4.000000000000001e-06
Epoch:114, Loss:0.6831601246887323, Acc:78.262, LR:4.000000000000001e-06
Validation: Loss:0.5136719971895218, Acc:87.33
Epoch:115, Loss:0.6836602929409366, Acc:82.124, LR:4.000000000000001e-06
Epoch:116, Loss:0.6390850282445246, Acc:80.608, LR:4.000000000000001e-06
Epoch:117, Loss:0.6901006558719947, Acc:81.41, LR:4.000000000000001e-06
Epoch:118, Loss:0.6893025459531619, Acc:80.9, LR:4.000000000000001e-06
Epoch:119, Loss:0.6507399127039374, Acc:86.766, LR:8.000000000000002e-07
Validation: Loss:0.5158258840441704, Acc:87.19
Epoch:120, Loss:0.6801307504730565, Acc:78.904, LR:8.000000000000002e-07
Epoch:121, Loss:0.6700155444595278, Acc:86.07, LR:8.000000000000002e-07
Epoch:122, Loss:0.6716353956381885, Acc:80.446, LR:8.000000000000002e-07
Epoch:123, Loss:0.6778023746244761, Acc:81.358, LR:8.000000000000002e-07
Epoch:124, Loss:0.6807208278653573, Acc:79.154, LR:8.000000000000002e-07
Validation: Loss:0.5152746215462685, Acc:87.16
Epoch:125, Loss:0.6524896149580576, Acc:81.59, LR:8.000000000000002e-07
Epoch:126, Loss:0.6594378492053674, Acc:80.838, LR:8.000000000000002e-07
Epoch:127, Loss:0.6552852315029928, Acc:81.026, LR:8.000000000000002e-07
Epoch:128, Loss:0.6771633691933691, Acc:83.066, LR:8.000000000000002e-07
Epoch:129, Loss:0.6726629631403758, Acc:80.568, LR:8.000000000000002e-07
Validation: Loss:0.5144774556159973, Acc:87.2
Epoch:130, Loss:0.6819094177715632, Acc:81.062, LR:8.000000000000002e-07
Epoch:131, Loss:0.6723851270175406, Acc:80.164, LR:8.000000000000002e-07
Epoch:132, Loss:0.6690064337180586, Acc:82.846, LR:8.000000000000002e-07
Epoch:133, Loss:0.7025381995707142, Acc:78.686, LR:8.000000000000002e-07
Epoch:134, Loss:0.6778926793105748, Acc:83.472, LR:8.000000000000002e-07
Validation: Loss:0.5142515957355499, Acc:87.16
Epoch:135, Loss:0.69489868644777, Acc:79.904, LR:8.000000000000002e-07
Epoch:136, Loss:0.6865009551449698, Acc:74.266, LR:8.000000000000002e-07
Epoch:137, Loss:0.6650975613417675, Acc:78.126, LR:8.000000000000002e-07
Epoch:138, Loss:0.6624292368639488, Acc:82.314, LR:8.000000000000002e-07
Epoch:139, Loss:0.6666492520622453, Acc:81.684, LR:8.000000000000002e-07
Validation: Loss:0.5146052375435829, Acc:87.18
Epoch:140, Loss:0.6728066604356376, Acc:79.884, LR:8.000000000000002e-07
Epoch:141, Loss:0.682294889068117, Acc:83.308, LR:8.000000000000002e-07
Epoch:142, Loss:0.6693981796198961, Acc:80.284, LR:8.000000000000002e-07
Epoch:143, Loss:0.6736630313858694, Acc:78.756, LR:8.000000000000002e-07
Epoch:144, Loss:0.6640473646777016, Acc:79.056, LR:8.000000000000002e-07
Validation: Loss:0.5151498511433601, Acc:87.2
Epoch:145, Loss:0.6501428448043916, Acc:84.046, LR:8.000000000000002e-07
Epoch:146, Loss:0.6331274306439624, Acc:83.102, LR:8.000000000000002e-07
Epoch:147, Loss:0.6682341335987558, Acc:79.498, LR:8.000000000000002e-07
Epoch:148, Loss:0.6636300426052542, Acc:84.246, LR:8.000000000000002e-07
Epoch:149, Loss:0.6491654426695741, Acc:87.796, LR:1.6000000000000006e-07
Validation: Loss:0.5158071473240853, Acc:87.18
Epoch:150, Loss:0.6456765252336556, Acc:83.912, LR:1.6000000000000006e-07
Epoch:151, Loss:0.6855332390690336, Acc:77.964, LR:1.6000000000000006e-07
Epoch:152, Loss:0.6898361877823362, Acc:78.176, LR:1.6000000000000006e-07
Epoch:153, Loss:0.661401383274672, Acc:80.188, LR:1.6000000000000006e-07
Epoch:154, Loss:0.703853467897493, Acc:76.248, LR:1.6000000000000006e-07
Validation: Loss:0.5155947297811508, Acc:87.23
Epoch:155, Loss:0.658337476910377, Acc:85.796, LR:1.6000000000000006e-07
Epoch:156, Loss:0.6656784421327163, Acc:82.704, LR:1.6000000000000006e-07
Epoch:157, Loss:0.6544775364882484, Acc:82.702, LR:1.6000000000000006e-07
Epoch:158, Loss:0.6839533712790937, Acc:80.956, LR:1.6000000000000006e-07
Epoch:159, Loss:0.6803219281897253, Acc:82.558, LR:1.6000000000000006e-07
Validation: Loss:0.5156661778688431, Acc:87.22
Epoch:160, Loss:0.6604880254183497, Acc:81.63, LR:1.6000000000000006e-07
Epoch:161, Loss:0.659075949189006, Acc:80.63, LR:1.6000000000000006e-07
Epoch:162, Loss:0.6487964227871628, Acc:83.78, LR:1.6000000000000006e-07
Epoch:163, Loss:0.70133353587316, Acc:75.75, LR:1.6000000000000006e-07
Epoch:164, Loss:0.6703287264598268, Acc:78.622, LR:1.6000000000000006e-07
Validation: Loss:0.5157107293605805, Acc:87.21
Epoch:165, Loss:0.6582449495184178, Acc:88.25, LR:1.6000000000000006e-07
Epoch:166, Loss:0.6664339487954062, Acc:75.018, LR:1.6000000000000006e-07
Epoch:167, Loss:0.6461273350429778, Acc:83.404, LR:1.6000000000000006e-07
Epoch:168, Loss:0.6328938020279213, Acc:83.56, LR:1.6000000000000006e-07
Epoch:169, Loss:0.6867479503306807, Acc:76.084, LR:1.6000000000000006e-07
Validation: Loss:0.5156748607754708, Acc:87.19
Epoch:170, Loss:0.6893635381545339, Acc:81.626, LR:1.6000000000000006e-07
Epoch:171, Loss:0.654424801658915, Acc:81.684, LR:1.6000000000000006e-07
Epoch:172, Loss:0.6680189777089625, Acc:82.726, LR:1.6000000000000006e-07
Epoch:173, Loss:0.6730344756981548, Acc:79.764, LR:1.6000000000000006e-07
Epoch:174, Loss:0.6541089598583628, Acc:80.052, LR:1.6000000000000006e-07
Validation: Loss:0.515686745941639, Acc:87.19
Epoch:175, Loss:0.6665030343039912, Acc:78.348, LR:1.6000000000000006e-07
Epoch:176, Loss:0.6407511845725228, Acc:81.25, LR:1.6000000000000006e-07
Epoch:177, Loss:0.6688416770526341, Acc:81.52, LR:1.6000000000000006e-07
Epoch:178, Loss:0.6519158296667191, Acc:82.89, LR:1.6000000000000006e-07
Epoch:179, Loss:0.6476391848860955, Acc:84.352, LR:3.2000000000000015e-08
Validation: Loss:0.515620905160904, Acc:87.23
Epoch:180, Loss:0.655628767738841, Acc:81.8, LR:3.2000000000000015e-08
Epoch:181, Loss:0.672162962621268, Acc:78.694, LR:3.2000000000000015e-08
Epoch:182, Loss:0.6627223142517769, Acc:80.688, LR:3.2000000000000015e-08
Epoch:183, Loss:0.6941507706532672, Acc:75.208, LR:3.2000000000000015e-08
Epoch:184, Loss:0.6869633392411836, Acc:78.27, LR:3.2000000000000015e-08
Validation: Loss:0.5156299114227295, Acc:87.22
Epoch:185, Loss:0.6688236350725804, Acc:79.424, LR:3.2000000000000015e-08
Epoch:186, Loss:0.6367124165503346, Acc:85.886, LR:3.2000000000000015e-08
Epoch:187, Loss:0.6660685391754521, Acc:87.274, LR:3.2000000000000015e-08
Epoch:188, Loss:0.6632031436477389, Acc:86.732, LR:3.2000000000000015e-08
Epoch:189, Loss:0.6636975146830082, Acc:80.574, LR:3.2000000000000015e-08
Validation: Loss:0.5155991420149804, Acc:87.24
Epoch:190, Loss:0.6548716363459065, Acc:86.234, LR:3.2000000000000015e-08
Epoch:191, Loss:0.6614599029476546, Acc:80.622, LR:3.2000000000000015e-08
Epoch:192, Loss:0.6869672509480496, Acc:81.176, LR:3.2000000000000015e-08
Epoch:193, Loss:0.6500395352439005, Acc:82.748, LR:3.2000000000000015e-08
Epoch:194, Loss:0.6409152463382605, Acc:84.286, LR:3.2000000000000015e-08
Validation: Loss:0.5155793443322182, Acc:87.24
Epoch:195, Loss:0.6551760938398692, Acc:86.738, LR:3.2000000000000015e-08
Epoch:196, Loss:0.6767033099063805, Acc:80.488, LR:3.2000000000000015e-08
Epoch:197, Loss:0.6596466725578114, Acc:87.492, LR:3.2000000000000015e-08
Epoch:198, Loss:0.6305933635377762, Acc:80.68, LR:3.2000000000000015e-08
Epoch:199, Loss:0.6865679281098502, Acc:80.144, LR:3.2000000000000015e-08
Validation: Loss:0.5156030833721161, Acc:87.24
Test: Acc:87.39
